/* 
 * Ace Editor Plugin for TinyMCE 4.0
 * By Daniel Jones - info@d-k-j.com
 */

tinymce.PluginManager.add("ace",function(e){function o(){function o(){return 50==a++?void clearTimeout(soddoffloop):void(soddoffloop=setTimeout(function(){$("#mce-ace-editor").hasClass("mce-container")&&$("#mce-ace-editor").removeClass("mce-container"),o()},100))}var t=$(window).innerWidth()-30,i=$(window).innerHeight()-120;t>1800&&(t=1800),i>1200&&(i=1200);var n=(t-20)%138;if(t=t-n+10,t>600){var n=(t-20)%138;t=t-n+10}if(e.windowManager.open({title:"Code Editor",type:"container",id:"mce-ace-editor",name:"ace",width:t,height:i,inline:1,buttons:[{text:"Ok",classes:"primary",onclick:function(){if("undefined"!=typeof c){var o=c.getValue();e.focus(),e.undoManager.transact(function(){e.setContent(o)}),e.selection.setCursorLocation(),e.nodeChanged(),e.windowManager.close()}}},{text:"Cancel",onclick:"close"}]}),$("#mce-ace-editor-body").length){$("#mce-ace-editor-body").append('<div id="mce-ace-editor-block"></div>'),$("#mce-ace-editor-block").css({position:"absolute",left:"0",right:"0",top:"0",bottom:"0"});var c=ace.edit("mce-ace-editor-block");c.setTheme("ace/theme/eclipse"),c.getSession().setMode("ace/mode/html"),c.setOptions({showPrintMargin:!1}),c.getSession().setUseWrapMode(!0),c.getSession().setValue(e.getContent({source_view:!0}))}var a=0;o()}e.addCommand("mceace_codeEditor",o),e.addButton("ace",{icon:"code",tooltip:"Code Editor",onclick:o}),e.addMenuItem("ace",{icon:"code",text:"Code Editor",context:"tools",onclick:o})});
